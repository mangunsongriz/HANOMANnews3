<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HANOMAN NEWS</title>
<style>
  body, html {
    margin:0; padding:0; height:100%;
    font-family: 'Courier New', Courier, monospace;
    background-color: #000;
    color: #e0e0e0;
    overflow-y: auto;
  }
  #splash {
    position: fixed;
    top:0; left:0; right:0; bottom:0;
    background: #000c;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    color: #0f0;
    z-index: 9999;
    font-size: 1.2rem;
  }
  #splash input[type=text] {
    padding: 10px;
    font-size: 1.2rem;
    width: 300px;
    max-width: 90vw;
    margin: 10px 0;
    background: #111;
    color: #0f0;
    border: 1px solid #0f0;
    border-radius: 5px;
  }
  #splash button {
    padding: 10px 20px;
    font-size: 1.2rem;
    background: #0f0;
    border: none;
    color: #000;
    cursor: pointer;
    border-radius: 5px;
  }
  header {
    text-align: center;
    padding: 10px;
    background: rgba(0,0,0,0.7);
    border-radius: 10px;
    margin: 10px 20px 20px;
    color: #0f0;
  }
  header h1 {
    margin:0; font-size: 2.5rem;
  }
  nav {
    text-align: center;
    margin: 10px 0 20px;
  }
  nav button {
    background-color: #111;
    color: #0f0;
    border: 1px solid #0f0;
    padding: 8px 14px;
    margin: 3px 6px;
    cursor: pointer;
    border-radius: 5px;
    font-weight: bold;
    transition: 0.3s;
  }
  nav button:hover {
    background-color: #0f0;
    color: #000;
  }
  #filters {
    max-width: 900px;
    margin: 0 auto 30px;
    text-align: center;
  }
  #filters select, #filters button {
    background: #111;
    border: 1px solid #0f0;
    color: #0f0;
    padding: 6px 10px;
    margin: 0 6px 10px;
    border-radius: 5px;
    font-size: 1rem;
  }
  #filters button:hover {
    background-color: #0f0;
    color: #000;
  }
  #berita-container {
    max-width: 1100px;
    margin: 0 auto 30px;
    display: grid;
    grid-template-columns: repeat(auto-fill,minmax(250px,1fr));
    gap: 18px;
    padding: 0 10px;
  }
  .news-item {
    background: rgba(0,0,0,0.7);
    border: 2px solid #0f0;
    border-radius: 8px;
    padding: 10px;
    display: flex;
    flex-direction: column;
    height: 100%;
    box-sizing: border-box;
    transition: background-color 0.3s;
  }
  .news-item:hover {
    background-color: #0a0;
  }
  .news-item img {
    width: 100%;
    max-height: 150px;
    object-fit: cover;
    border-radius: 5px;
    margin-bottom: 8px;
    cursor: pointer;
  }
  .news-item .category {
    color: #ffcc00;
    font-weight: bold;
    margin-bottom: 5px;
  }
  .news-item strong a {
    color: #0f0;
    text-decoration: none;
    font-size: 1.1rem;
  }
  .news-item strong a:hover {
    text-decoration: underline;
  }
  .news-item .date {
    font-size: 0.8rem;
    color: #aaa;
    margin-top: auto;
    text-align: right;
  }
  .footer {
    text-align: center;
    margin: 20px 10px 30px;
    font-size: 0.9rem;
    color: #555;
  }
  #visitor-section {
    max-width: 500px;
    margin: 0 auto 40px;
    background: rgba(0,0,0,0.6);
    border: 1px solid #0f0;
    border-radius: 8px;
    padding: 15px;
    color: #0f0;
    font-size: 1rem;
  }
  #visitor-section input[type=text] {
    width: 70%;
    padding: 6px 8px;
    background: #111;
    border: 1px solid #0f0;
    border-radius: 4px;
    color: #0f0;
    font-size: 1rem;
  }
  #visitor-section button {
    padding: 6px 14px;
    margin-left: 6px;
    background: #0f0;
    border: none;
    color: #000;
    font-weight: bold;
    cursor: pointer;
    border-radius: 4px;
  }
  #visitor-list {
    margin-top: 12px;
    max-height: 150px;
    overflow-y: auto;
    border-top: 1px solid #0f0;
    padding-top: 8px;
  }
</style>
</head>
<body>

<div id="splash">
  <div>Masukkan nama kamu dulu, bro!</div>
  <input type="text" id="visitor-name-splash" placeholder="Nama kamu..." />
  <button onclick="submitName()">Masuk</button>
</div>

<header>
  <h1>HANOMAN NEWS</h1>
  <p>Portal Intelijen Nasional</p>
</header>

<nav>
  <button onclick="fetchRSS('all')">Semua</button>
  <button onclick="fetchRSS('nasional')">Nasional</button>
  <button onclick="fetchRSS('papua')">Papua</button>
  <button onclick="fetchRSS('maluku')">Maluku</button>
  <button onclick="fetchRSS('regional')">Regional</button>
  <button onclick="fetchRSS('internasional')">Internasional</button>
  <button onclick="fetchRSS('cyber')">Cyber</button>
  <button onclick="fetchRSS('hotzone')">Hot Zone</button>
  <button onclick="fetchRSS('ekonomi')">Ekonomi</button>
</nav>

<div id="filters" style="display:none;">
  <select id="filterYear" onchange="updateMonthOptions()"></select>
  <select id="filterMonth" onchange="updateDayOptions()" disabled></select>
  <select id="filterDay" disabled></select>
  <button onclick="applyAdvancedDateFilter()">Filter Tanggal</button>
  <button onclick="resetAdvancedDateFilter()">Reset Filter</button>
</div>

<div id="berita-container">Memuat berita terkini...</div>

<div id="visitor-section" style="display:none;">
  <div>Jumlah pengunjung yang sudah mengisi nama: <span id="visitor-count">0</span></div>
  <div>
    <input type="text" id="visitor-name" placeholder="Masukkan nama pengunjung..." />
    <button onclick="addVisitor()">Tambah Nama</button>
  </div>
  <div id="visitor-list"><i>Belum ada pengunjung yang mengisi nama.</i></div>
</div>

<div class="footer">
  &copy; 2025 HANOMAN NEWS - Dibangun untuk ketahanan informasi nasional.
</div>

<script>
  // Escape HTML untuk keamanan input user
  function escapeHTML(text) {
    return text.replace(/[&<>"']/g, m => ({'&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#39;'}[m]));
  }

  // Visitor name splash screen logic
  const splashDiv = document.getElementById('splash');
  const visitorNameSplash = document.getElementById('visitor-name-splash');
  let visitors = JSON.parse(localStorage.getItem('hanoman_visitors') || '[]');
  let currentVisitorName = localStorage.getItem('hanoman_currentVisitor') || '';

  function submitName() {
    let name = visitorNameSplash.value.trim();
    if(name.length < 2){
      alert('Nama harus minimal 2 karakter, bro!');
      visitorNameSplash.focus();
      return;
    }
    currentVisitorName = name;
    localStorage.setItem('hanoman_currentVisitor', currentVisitorName);

    if(!visitors.includes(currentVisitorName)) {
      visitors.push(currentVisitorName);
      localStorage.setItem('hanoman_visitors', JSON.stringify(visitors));
    }

    splashDiv.style.display = 'none';
    showMainContent();
  }

  function showMainContent() {
    document.getElementById('filters').style.display = 'block';
    document.getElementById('visitor-section').style.display = 'block';
    updateVisitorCount();
    fetchRSS('all');
  }

  if(currentVisitorName && currentVisitorName.length >= 2){
    splashDiv.style.display = 'none';
    showMainContent();
  }

  // RSS Feeds URLs (20 per category)
  const feeds = {
    nasional: [
      'https://www.antaranews.com/rss/nasional.xml',
      'https://nasional.kompas.com/rss',
      'https://republika.co.id/rss/nasional',
      'https://www.sindonews.com/feed/nasional',
      'https://www.liputan6.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=5',
      'https://www.merdeka.com/rss/nasional',
      'https://news.detik.com/rss/nasional',
      'https://www.cnnindonesia.com/nasional/rss',
      'https://www.tribunnews.com/rss/nasional',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml'
    ],
    papua: [
      'https://kabarpapua.co/feed/',
      'https://www.papuapos.com/feed/',
      'https://www.papuatoday.com/feed/',
      'https://www.tabloidjubi.com/feed/',
      'https://seputarpapua.com/feed/',
      'https://papuakita.com/feed/',
      'https://beritapapua.id/feed/',
      'https://www.rri.co.id/rss/regional/papua',
      'https://www.antaranews.com/rss/regional/papua.xml',
      'https://www.papuaweb.org/rss.xml',
      'https://www.malukunews.co/feed/papua',
      'https://www.papuanews.id/feed/',
      'https://papua.rmol.id/feed/',
      'https://papua.antaranews.com/rss.xml',
      'https://www.tribunnews.com/rss/papua',
      'https://papuaterkini.com/feed/',
      'https://www.jubi.co.id/feed/',
      'https://www.merdeka.com/rss/papua',
      'https://www.liputan6.com/rss/papua',
      'https://www.cnnindonesia.com/daerah/rss/papua'
    ],
    maluku: [
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/',
      'https://ambonexpress.com/feed/',
      'https://kabarindonesianews.com/feed/',
      'https://www.rri.co.id/rss/regional/maluku',
      'https://malukupost.com/rss',
      'https://www.suarakabarambon.com/feed/',
      'https://www.rmolmaluku.id/feed/',
      'https://www.antaranews.com/rss/regional/maluku.xml',
      'https://www.tribunnews.com/rss/maluku',
      'https://www.jpnn.com/index.php?mib=rss&id=27',
      'https://www.liputan6.com/rss/maluku',
      'https://www.kumparan.com/rss/maluku',
      'https://www.radaronline.id/rss/maluku',
      'https://www.indozone.id/rss/maluku',
      'https://maluku.kompas.com/rss',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.cnnindonesia.com/nasional/rss',
      'https://www.suara.com/rss/maluku',
      'https://www.tempo.co/rss/maluku'
    ],
    regional: [
      'https://www.rri.co.id/rss/regional',
      'https://www.malukunews.co/rss.xml',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://regional.tempo.co/rss',
      'https://regional.metrotvnews.com/rss',
      'https://www.tribunnews.com/rss/regional',
      'https://regional.okezone.com/rss',
      'https://regional.kontan.co.id/rss',
      'https://www.antaranews.com/rss/regional',
      'https://www.cnnindonesia.com/daerah/rss',
      'https://www.jpnn.com/index.php?mib=rss&id=16',
      'https://www.viva.co.id/rss/indeks/daerah',
      'https://www.beritasatu.com/rss/daerah',
      'https://www.suara.com/rss/daerah',
      'https://www.kumparan.com/rss/daerah',
      'https://www.radaronline.id/rss/daerah',
      'https://www.indozone.id/rss/daerah',
      'https://www.liputan6.com/rss/daerah'
    ],
    internasional: [
      'https://www.dw.com/en/top-stories/s-9097/sitemap.xml',
      'https://www.rt.com/rss/news/',
      'https://www.nbcnews.com/id/3032091/device/rss/rss.xml',
      'https://www.usatoday.com/rss/news',
      'https://www.cbsnews.com/latest/rss/main',
      'https://www.aljazeera.com/xml/rss/all.xml',
      'https://www.bloomberg.com/feed/podcast/rss',
      'https://www.reuters.com/rssFeed/worldNews',
      'https://www.bbc.com/indonesia/index.xml',
      'https://rss.nytimes.com/services/xml/rss/nyt/World.xml',
      'https://www.abc.net.au/news/feed/51120/rss.xml',
      'https://www.cnn.com/rss/edition_world.rss',
      'https://feeds.npr.org/1004/rss.xml',
      'https://www.france24.com/en/rss',
      'https://www.theguardian.com/world/rss',
      'https://www.npr.org/rss/rss.php?id=1004',
      'https://www.voanews.com/rss',
      'https://www.euronews.com/rss',
      'https://www.dw.com/en/rss-feed/s-8030',
      'https://www.aljazeera.com/xml/rss/all.xml'
    ],
    cyber: [
      'https://www.antaranews.com/rss/tekno.xml',
      'https://tekno.kompas.com/rss',
      'https://www.cnnindonesia.com/teknologi/rss',
      'https://www.liputan6.com/rss/tekno',
      'https://tekno.tempo.co/rss/it',
      'https://www.gizmochina.com/feed/',
      'https://www.theverge.com/rss/index.xml',
      'https://www.engadget.com/rss.xml',
      'https://www.wired.com/feed/rss',
      'https://www.techradar.com/rss',
      'https://arstechnica.com/feed/',
      'https://www.zdnet.com/news/rss.xml',
      'https://www.macrumors.com/macrumors.xml',
      'https://www.cnet.com/rss/news/',
      'https://www.androidauthority.com/feed/',
      'https://www.techspot.com/backend.xml',
      'https://www.techcrunch.com/feed/',
      'https://thenextweb.com/feed/',
      'https://www.digitaltrends.com/feed/',
      'https://www.tomshardware.com/feeds/all'
    ],
    hotzone: [
      'https://www.antaranews.com/rss/hukum.xml',
      'https://www.cnnindonesia.com/nasional/rss',
      'https://news.detik.com/rss',
      'https://www.tribunnews.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=2',
      'https://www.metrotvnews.com/rss/hukum',
      'https://www.liputan6.com/rss/hukum',
      'https://www.tribunnews.com/rss/hukum',
      'https://www.cnnindonesia.com/hukum/rss',
      'https://news.okezone.com/rss/hukum',
      'https://www.pikiran-rakyat.com/rss/hukum',
      'https://www.kabarindonesia.com/rss/hukum',
      'https://www.suara.com/rss/hukum',
      'https://www.kompas.com/rss/hukum',
      'https://www.tempo.co/rss/nasional',
      'https://www.antarafoto.com/rss/hukum',
      'https://www.beritasatu.com/rss/hukum',
      'https://www.radaronline.id/rss/hukum',
      'https://www.viva.co.id/rss/hukum',
      'https://www.kumparan.com/rss/hukum'
    ],
    ekonomi: [
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://ekonomi.kompas.com/rss',
      'https://www.cnbcindonesia.com/rss',
      'https://finance.detik.com/rss',
      'https://bisnis.tempo.co/rss/nasional',
      'https://www.liputan6.com/rss/ekonomi',
      'https://www.jpnn.com/index.php?mib=rss&id=10',
      'https://www.sindonews.com/feed/ekonomi',
      'https://www.tribunnews.com/rss/ekonomi',
      'https://www.cnnindonesia.com/ekonomi/rss',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml'
    ]
  };

  let currentCategory = 'all';
  let allNews = [];
  let filteredNews = [];
  let filteredByDate = null;

  // Ambil dan gabung semua feeds kategori
  function fetchRSS(category){
    currentCategory = category;
    filteredByDate = null;
    document.getElementById('berita-container').innerHTML = 'Memuat berita...';
    document.getElementById('filterYear').innerHTML = '';
    document.getElementById('filterMonth').innerHTML = '';
    document.getElementById('filterDay').innerHTML = '';
    document.getElementById('filterMonth').disabled = true;
    document.getElementById('filterDay').disabled = true;

    if(category === 'all'){
      // Gabungkan semua kategori feed ke satu array URL
      let urls = [];
      for(let key in feeds) {
        urls = urls.concat(feeds[key]);
      }
      loadAllFeeds(urls).then(news => {
        allNews = news.sort((a,b) => new Date(b.fullDate) - new Date(a.fullDate));
        filteredNews = [...allNews];
        renderNews(filteredNews);
        setupDateFilters(allNews);
      });
    } else {
      loadAllFeeds(feeds[category]).then(news => {
        allNews = news.sort((a,b) => new Date(b.fullDate) - new Date(a.fullDate));
        filteredNews = [...allNews];
        renderNews(filteredNews);
        setupDateFilters(allNews);
      });
    }
  }

  // Load semua URL RSS satu per satu dan gabungkan hasilnya
  function loadAllFeeds(urls){
    const promises = urls.map(url => loadFeed(url));
    return Promise.all(promises).then(results => {
      return results.flat();
    });
  }

  // Load satu feed
  function loadFeed(url){
    return fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`)
      .then(res => res.json())
      .then(data => {
        if(!data.items) return [];
        return data.items.map(item => ({
          title: item.title || "Judul tidak tersedia",
          thumbnail: item.thumbnail || item.enclosure?.link || '',
          date: item.pubDate ? item.pubDate.split(' ')[0] : '',
          fullDate: item.pubDate || '',
          link: item.link || '#',
          category: item.category || ''
        }));
      })
      .catch(() => []);
  }

  // Render berita ke grid
  function renderNews(newsArray){
    const container = document.getElementById('berita-container');
    container.innerHTML = '';
    if(newsArray.length === 0){
      container.innerHTML = "<div style='color:#f00; font-weight:bold; text-align:center; margin-top:50px;'>Tidak ada berita pada rentang tanggal tersebut.</div>";
      return;
    }
    newsArray.forEach(news => {
      const div = document.createElement('div');
      div.className = 'news-item';
      div.innerHTML = `
        <div class="category">${escapeHTML(news.category)}</div>
        ${news.thumbnail ? `<a href="${news.link}" target="_blank" rel="noopener noreferrer"><img src="${news.thumbnail}" alt="thumbnail"/></a>` : ''}
        <strong><a href="${news.link}" target="_blank" rel="noopener noreferrer">${escapeHTML(news.title)}</a></strong>
        <div class="date">${escapeHTML(news.fullDate)}</div>
      `;
      container.appendChild(div);
    });
  }

  // SETUP FILTER TANGGAL
  const yearSelect = document.getElementById('filterYear');
  const monthSelect = document.getElementById('filterMonth');
  const daySelect = document.getElementById('filterDay');

  function setupDateFilters(newsArray){
    // ambil semua tanggal unik dari berita
    const dates = newsArray.map(n => n.fullDate).filter(d => d).map(d => new Date(d));
    const uniqueYears = [...new Set(dates.map(d => d.getFullYear()))].sort((a,b)=>b-a);
    yearSelect.innerHTML = '<option value="">-- Tahun --</option>';
    uniqueYears.forEach(y => yearSelect.innerHTML += `<option value="${y}">${y}</option>`);
    monthSelect.innerHTML = '<option value="">-- Bulan --</option>';
    monthSelect.disabled = true;
    daySelect.innerHTML = '<option value="">-- Hari --</option>';
    daySelect.disabled = true;
  }

  function updateMonthOptions(){
    const year = parseInt(yearSelect.value);
    if(!year){
      monthSelect.innerHTML = '<option value="">-- Bulan --</option>';
      monthSelect.disabled = true;
      daySelect.innerHTML = '<option value="">-- Hari --</option>';
      daySelect.disabled = true;
      return;
    }
    // Filter bulan yang ada di tahun tersebut
    const filteredDates = allNews.filter(n => {
      const dt = new Date(n.fullDate);
      return dt.getFullYear() === year;
    }).map(n => new Date(n.fullDate));
    const uniqueMonths = [...new Set(filteredDates.map(d => d.getMonth()))].sort((a,b)=>a-b);
    monthSelect.innerHTML = '<option value="">-- Bulan --</option>';
    uniqueMonths.forEach(m => {
      monthSelect.innerHTML += `<option value="${m}">${m+1}</option>`;
    });
    monthSelect.disabled = false;
    daySelect.innerHTML = '<option value="">-- Hari --</option>';
    daySelect.disabled = true;
  }

  function updateDayOptions(){
    const year = parseInt(yearSelect.value);
    const month = parseInt(monthSelect.value);
    if(isNaN(year) || isNaN(month)){
      daySelect.innerHTML = '<option value="">-- Hari --</option>';
      daySelect.disabled = true;
      return;
    }
    // Filter hari yang ada di bulan dan tahun itu
    const filteredDates = allNews.filter(n => {
      const dt = new Date(n.fullDate);
      return dt.getFullYear() === year && dt.getMonth() === month;
    }).map(n => new Date(n.fullDate));
    const uniqueDays = [...new Set(filteredDates.map(d => d.getDate()))].sort((a,b)=>a-b);
    daySelect.innerHTML = '<option value="">-- Hari --</option>';
    uniqueDays.forEach(d => {
      daySelect.innerHTML += `<option value="${d}">${d}</option>`;
    });
    daySelect.disabled = false;
  }

  // Terapkan filter tanggal kompleks
  function applyAdvancedDateFilter(){
    const year = yearSelect.value;
    const month = monthSelect.value;
    const day = daySelect.value;

    filteredByDate = allNews.filter(n => {
      const dt = new Date(n.fullDate);
      if(year && dt.getFullYear() != year) return false;
      if(month && dt.getMonth() != month) return false;
      if(day && dt.getDate() != day) return false;
      return true;
    });
    renderNews(filteredByDate);
  }

  function resetAdvancedDateFilter(){
    filteredByDate = null;
    yearSelect.value = '';
    monthSelect.innerHTML = '<option value="">-- Bulan --</option>';
    monthSelect.disabled = true;
    daySelect.innerHTML = '<option value="">-- Hari --</option>';
    daySelect.disabled = true;
    renderNews(allNews);
  }

  // VISITOR SECTION
  const visitorCountSpan = document.getElementById('visitor-count');
  const visitorListDiv = document.getElementById('visitor-list');
  const visitorNameInput = document.getElementById('visitor-name');

  function updateVisitorCount(){
    visitorCountSpan.textContent = visitors.length;
    if(visitors.length === 0){
      visitorListDiv.innerHTML = '<i>Belum ada pengunjung yang mengisi nama.</i>';
    } else {
      visitorListDiv.innerHTML = visitors.map(v => escapeHTML(v)).join('<br>');
    }
  }

  function addVisitor(){
    let name = visitorNameInput.value.trim();
    if(name.length < 2){
      alert('Nama minimal 2 karakter, bro!');
      visitorNameInput.focus();
      return;
    }
    if(!visitors.includes(name)){
      visitors.push(name);
      localStorage.setItem('hanoman_visitors', JSON.stringify(visitors));
      updateVisitorCount();
    }
    visitorNameInput.value = '';
  }

</script>
</body>
</html>


