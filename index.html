<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>HANOMAN NEWS - Portal Intelijen Nasional</title>
<style>
  body {
    font-family: 'Courier New', Courier, monospace;
    background-color: #000;
    color: #0f0;
    margin: 0; padding: 20px;
  }
  #splash {
    position: fixed; top: 0; left: 0; right: 0; bottom: 0;
    background: rgba(0,0,0,0.95);
    display: flex; flex-direction: column;
    justify-content: center; align-items: center;
    z-index: 9999;
  }
  #splash input {
    font-size: 1.5em;
    padding: 10px;
    margin-top: 15px;
    width: 280px;
    background: #111;
    color: #0f0;
    border: 2px solid #0f0;
    border-radius: 6px;
    outline: none;
  }
  #splash button {
    margin-top: 15px;
    font-size: 1.3em;
    padding: 10px 25px;
    background: #0f0;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    color: #000;
    font-weight: bold;
    transition: background 0.3s ease;
  }
  #splash button:hover {
    background: #6f6;
  }

  header {
    text-align: center;
    padding: 10px;
    background: rgba(0,0,0,0.7);
    margin-bottom: 20px;
    border-radius: 10px;
  }
  h1 {
    margin: 0;
    font-size: 2.5em;
    color: #00ff00;
  }
  nav {
    text-align: center;
    margin-bottom: 15px;
  }
  nav button {
    background-color: #111;
    color: #00ff00;
    border: 1px solid #00ff00;
    padding: 8px 12px;
    margin: 3px;
    cursor: pointer;
    border-radius: 5px;
    font-size: 0.9em;
    transition: background 0.3s, color 0.3s;
  }
  nav button:hover, nav button.active {
    background-color: #00ff00;
    color: #111;
  }

  #filters {
    display: none;
    justify-content: center;
    gap: 10px;
    margin-bottom: 20px;
  }
  #filters select {
    background: #111;
    color: #0f0;
    border: 1px solid #0f0;
    padding: 6px 10px;
    border-radius: 5px;
    font-size: 1em;
    outline: none;
  }
  #filters button {
    background: #0f0;
    border: none;
    color: #000;
    padding: 6px 12px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s ease;
  }
  #filters button:hover {
    background: #6f6;
  }

  #berita-container {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 12px;
  }
  .news-item {
    background: rgba(0,0,0,0.6);
    border-left: 5px solid #00ff00;
    border-radius: 6px;
    padding: 10px;
    color: #e0e0e0;
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
  }
  .news-item img {
    width: 100%;
    max-height: 150px;
    object-fit: cover;
    border-radius: 5px;
    margin-bottom: 8px;
  }
  .news-item .category {
    color: #ffcc00;
    font-weight: bold;
    margin-bottom: 4px;
    font-size: 0.85em;
  }
  .news-item strong {
    font-size: 1.1em;
    margin-bottom: 6px;
  }
  .news-item .date {
    font-size: 0.8em;
    color: #999;
    margin-top: auto;
    font-style: italic;
  }

  #visitor-section {
    margin-top: 25px;
    padding: 15px;
    background: rgba(0,0,0,0.7);
    border-radius: 8px;
  }
  #visitor-section input[type=text] {
    background: #111;
    border: 1px solid #0f0;
    color: #0f0;
    padding: 8px;
    border-radius: 5px;
    width: 200px;
    font-size: 1em;
    outline: none;
  }
  #visitor-section button {
    background: #0f0;
    border: none;
    color: #000;
    padding: 8px 15px;
    border-radius: 5px;
    cursor: pointer;
    font-weight: bold;
    margin-left: 8px;
    transition: background 0.3s ease;
  }
  #visitor-section button:hover {
    background: #6f6;
  }
  #visitor-list {
    margin-top: 12px;
    color: #0f0;
    font-size: 0.95em;
    max-height: 140px;
    overflow-y: auto;
    border: 1px solid #0f0;
    padding: 10px;
    border-radius: 6px;
    background: #111;
  }
  #visitor-count {
    font-weight: bold;
  }

  footer {
    margin-top: 40px;
    text-align: center;
    font-size: 0.8em;
    color: #666;
  }

  @media(max-width:1200px) {
    #berita-container {
      grid-template-columns: repeat(3, 1fr);
    }
  }
  @media(max-width:700px) {
    #berita-container {
      grid-template-columns: repeat(1, 1fr);
    }
  }
</style>
</head>
<body>

<!-- Splash Screen input nama -->
<div id="splash">
  <div>Masukkan Nama Kamu untuk Masuk:</div>
  <input type="text" id="visitor-name-splash" placeholder="Nama kamu..." autofocus />
  <button onclick="submitName()">Masuk</button>
</div>

<!-- Konten utama -->
<div id="main-content" style="display:none;">
  <header>
    <h1>HANOMAN NEWS</h1>
    <p>Portal Intelijen Nasional</p>
  </header>

  <nav id="category-nav">
    <button data-cat="all" class="active" onclick="fetchRSS('all', this)">Semua</button>
    <button data-cat="nasional" onclick="fetchRSS('nasional', this)">Nasional</button>
    <button data-cat="papua" onclick="fetchRSS('papua', this)">Papua</button>
    <button data-cat="maluku" onclick="fetchRSS('maluku', this)">Maluku</button>
    <button data-cat="regional" onclick="fetchRSS('regional', this)">Regional</button>
    <button data-cat="internasional" onclick="fetchRSS('internasional', this)">Internasional</button>
    <button data-cat="cyber" onclick="fetchRSS('cyber', this)">Cyber</button>
    <button data-cat="hotzone" onclick="fetchRSS('hotzone', this)">Hot Zone</button>
    <button data-cat="ekonomi" onclick="fetchRSS('ekonomi', this)">Ekonomi</button>
  </nav>

  <div id="filters" style="display:none;">
    <select id="filterYear" onchange="onYearChange()"></select>
    <select id="filterMonth" onchange="onMonthChange()" disabled></select>
    <select id="filterDay" onchange="applyAdvancedDateFilter()" disabled></select>
    <button onclick="resetAdvancedDateFilter()">Reset Filter</button>
  </div>

  <div id="berita-container">Memuat berita...</div>

  <section id="visitor-section">
    <h3>Pengunjung: <span id="visitor-count">0</span></h3>
    <input type="text" id="visitor-name" placeholder="Tambah nama pengunjung..." />
    <button onclick="addVisitor()">Tambah</button>
    <div id="visitor-list"><i>Belum ada pengunjung yang mengisi nama.</i></div>
  </section>

  <footer>
    &copy; 2025 HANOMAN NEWS - Dibangun untuk ketahanan informasi nasional.
  </footer>
</div>

<script>
  // Feed RSS tiap kategori, tiap kategori ada array url maksimal 20 sumber
  const feeds = {
    nasional: [
      'https://www.antaranews.com/rss/nasional.xml',
      'https://nasional.kompas.com/rss',
      'https://republika.co.id/rss/nasional',
      'https://www.sindonews.com/feed/nasional',
      'https://www.liputan6.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=5',
      'https://www.merdeka.com/rss/nasional',
      'https://www.tribunnews.com/rss/nasional',
      'https://news.detik.com/rss',
      'https://www.cnnindonesia.com/nasional/rss',
      'https://www.viva.co.id/rss/indeks/nasional',
      'https://www.okezone.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.beritasatu.com/nasional/rss',
      'https://www.tempo.co/rss/nasional',
      'https://www.radaronline.co.id/feed/',
      'https://www.suara.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=5',
      'https://www.merdeka.com/rss/nasional',
      'https://www.tribunnews.com/rss/nasional'
    ],
    papua: [
      'https://kabarpapua.co/feed/',
      'https://www.papuapos.com/feed/',
      'https://www.papuatoday.com/feed/',
      'https://www.tabloidjubi.com/feed/',
      'https://seputarpapua.com/feed/',
      'https://www.papuaexpress.co/feed/',
      'https://www.beritapapua.id/feed/',
      'https://www.papuanews.co/feed/',
      'https://www.suarapapua.com/feed/',
      'https://www.papuainformasibaru.com/feed/',
      'https://www.papua24.com/feed/',
      'https://www.tribunnews.com/rss/papua',
      'https://www.antaranews.com/rss/regional',
      'https://www.malukunews.co/feed/',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/',
      'https://ambonexpress.com/feed/'
    ],
    maluku: [
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/',
      'https://ambonexpress.com/feed/',
      'https://kabarindonesianews.com/feed/',
      'https://www.rri.co.id/rss/regional/maluku',
      'https://www.antaranews.com/rss/regional',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://www.malukunews.co/feed/',
      'https://www.suaramaluku.com/feed/',
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/',
      'https://ambonexpress.com/feed/',
      'https://kabarindonesianews.com/feed/',
      'https://www.rri.co.id/rss/regional/maluku',
      'https://www.antaranews.com/rss/regional',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss'
    ],
    regional: [
      'https://www.rri.co.id/rss/regional',
      'https://www.malukunews.co/rss.xml',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/',
      'https://ambonexpress.com/feed/',
      'https://kabarindonesianews.com/feed/',
      'https://www.rri.co.id/rss/regional/maluku',
      'https://www.antaranews.com/rss/regional',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://www.malukunews.co/rss.xml',
      'https://regional.kompas.com/rss',
      'https://www.liputan6.com/rss/regional',
      'https://daerah.sindonews.com/rss',
      'https://beritamalukuonline.com/feed/',
      'https://www.satumaluku.id/feed/'
    ],
    internasional: [
      'https://www.antaranews.com/rss/internasional.xml',
      'https://www.bbc.com/indonesia/index.xml',
      'https://rss.nytimes.com/services/xml/rss/nyt/World.xml',
      'https://www.aljazeera.com/xml/rss/all.xml',
      'https://feeds.bbci.co.uk/news/world/rss.xml',
      'https://www.cnn.com/rss/edition_world.rss',
      'https://www.npr.org/rss/rss.php?id=1004',
      'https://www.reutersagency.com/feed/?best-sectors=world-news',
      'https://www.voanews.com/api/zmg-xml',
      'https://www.theguardian.com/world/rss',
      'https://www.euronews.com/rss?level=theme&name=world',
      'https://www.dw.com/en/top-stories/world/s-9097',
      'https://globalnews.ca/feed/',
      'https://www.france24.com/en/rss',
      'https://www.aljazeera.com/xml/rss/all.xml',
      'https://feeds.npr.org/1004/rss.xml',
      'https://rss.cnn.com/rss/edition_world.rss',
      'https://rss.dw.com/xml/rss-en-all.xml',
      'https://www.bbc.co.uk/news/10628494',
      'https://www.nytimes.com/services/xml/rss/nyt/World.xml'
    ],
    cyber: [
      'https://www.antaranews.com/rss/tekno.xml',
      'https://tekno.kompas.com/rss',
      'https://www.cnnindonesia.com/teknologi/rss',
      'https://www.liputan6.com/rss/tekno',
      'https://tekno.tempo.co/rss/it',
      'https://www.theverge.com/rss/index.xml',
      'https://www.wired.com/feed/rss',
      'https://feeds.arstechnica.com/arstechnica/index',
      'https://www.engadget.com/rss.xml',
      'https://www.gizmodo.com/rss',
      'https://mashable.com/feed/',
      'https://thenextweb.com/feed/',
      'https://www.zdnet.com/news/rss.xml',
      'https://www.cnet.com/rss/news/',
      'https://www.techradar.com/rss',
      'https://www.techcrunch.com/feed/',
      'https://www.digitaltrends.com/feed/',
      'https://venturebeat.com/feed/',
      'https://www.cnet.com/rss/tech/',
      'https://www.wired.com/feed/rss'
    ],
    hotzone: [
      'https://www.antaranews.com/rss/hukum.xml',
      'https://www.cnnindonesia.com/nasional/rss',
      'https://news.detik.com/rss',
      'https://www.tribunnews.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=2',
      'https://www.republika.co.id/rss/nasional',
      'https://www.liputan6.com/rss/nasional',
      'https://www.merdeka.com/rss/nasional',
      'https://www.viva.co.id/rss/indeks/nasional',
      'https://www.okezone.com/rss/nasional.xml',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://www.beritasatu.com/nasional/rss',
      'https://www.tempo.co/rss/nasional',
      'https://www.radaronline.co.id/feed/',
      'https://www.suara.com/rss/nasional',
      'https://www.jpnn.com/index.php?mib=rss&id=5',
      'https://www.merdeka.com/rss/nasional',
      'https://www.tribunnews.com/rss/nasional',
      'https://www.antaranews.com/rss/nasional.xml',
      'https://nasional.kompas.com/rss'
    ],
    ekonomi: [
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://ekonomi.kompas.com/rss',
      'https://www.cnbcindonesia.com/rss',
      'https://finance.detik.com/rss',
      'https://bisnis.tempo.co/rss/nasional',
      'https://www.liputan6.com/rss/ekonomi',
      'https://www.idxchannel.com/rss',
      'https://www.suara.com/rss/ekonomi',
      'https://www.kontan.co.id/rss',
      'https://www.okezone.com/rss/ekonomi.xml',
      'https://www.antaranews.com/rss/ekonomi.xml',
      'https://ekonomi.kompas.com/rss',
      'https://www.cnbcindonesia.com/rss',
      'https://finance.detik.com/rss',
      'https://bisnis.tempo.co/rss/nasional',
      'https://www.liputan6.com/rss/ekonomi',
      'https://www.idxchannel.com/rss',
      'https://www.suara.com/rss/ekonomi',
      'https://www.kontan.co.id/rss',
      'https://www.okezone.com/rss/ekonomi.xml'
    ]
  };

  // Simpan semua berita terakhir untuk filter tanggal
  let allNews = [];
  let filteredNews = [];
  let currentCategory = 'all';

  // Helper function parse date to yyyy-mm-dd
  function formatDateISO(dateStr){
    let d = new Date(dateStr);
    if(isNaN(d)) return '';
    return d.toISOString().split('T')[0];
  }

  // Load RSS dari semua URL kategori (max 20) lalu render
  async function fetchRSS(category, btn=null){
    const container = document.getElementById("berita-container");
    container.innerHTML = "Memuat berita...";

    // Update active button
    if(btn){
      document.querySelectorAll('#category-nav button').forEach(b=>{
        b.classList.remove('active');
      });
      btn.classList.add('active');
    }

    currentCategory = category;
    allNews = [];

    if(category === 'all'){
      // Semua kategori semua feeds
      let promises = [];
      for(let cat in feeds){
        feeds[cat].forEach(url => promises.push(loadFeed(url, cat)));
      }
      const results = await Promise.all(promises);
      allNews = results.flat();
    } else {
      let promises = feeds[category].map(url => loadFeed(url, category));
      const results = await Promise.all(promises);
      allNews = results.flat();
    }

    // Sort by newest date
    allNews = allNews.filter(item => item.title && item.date).sort((a,b)=> new Date(b.date) - new Date(a.date));
    filteredNews = [...allNews];

    // Show date filters if there's news
    document.getElementById('filters').style.display = allNews.length > 0 ? 'flex' : 'none';
    populateDateFilters(allNews);

    renderNews(filteredNews);
  }

  // Load satu RSS feed via rss2json API
  async function loadFeed(url, category){
    try{
      const res = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${encodeURIComponent(url)}`);
      const data = await res.json();
      if(!data.items) return [];

      return data.items.map(item => ({
        title: item.title,
        thumbnail: item.thumbnail || item.enclosure?.link || '',
        date: formatDateISO(item.pubDate),
        fullDate: item.pubDate,
        category: category
      }));
    }catch(e){
      return [{
        title: `Gagal memuat RSS: ${url}`,
        thumbnail: '',
        date: '',
        fullDate: '',
        category: category
      }];
    }
  }

  // Render array berita ke container grid
  function renderNews(newsArray){
    const container = document.getElementById("berita-container");
    container.innerHTML = "";

    if(newsArray.length === 0){
      container.innerHTML = "<i>Tidak ada berita yang sesuai filter.</i>";
      return;
    }

    newsArray.forEach(news => {
      const item = document.createElement("div");
      item.className = "news-item";
      item.innerHTML = `
        <div class="category">${news.category}</div>
        ${news.thumbnail ? `<img src="${news.thumbnail}" alt="thumbnail"/>` : ''}
        <strong>${news.title}</strong>
        <div class="date">${news.fullDate}</div>
      `;
      container.appendChild(item);
    });
  }

  // Date filter helpers
  function populateDateFilters(newsArray){
    let years = new Set();
    let months = new Set();
    let days = new Set();

    newsArray.forEach(n => {
      if(n.date){
        years.add(n.date.substring(0,4));
      }
    });

    const yearSelect = document.getElementById('filterYear');
    const monthSelect = document.getElementById('filterMonth');
    const daySelect = document.getElementById('filterDay');

    // Reset all
    yearSelect.innerHTML = '<option value="">Tahun</option>';
    monthSelect.innerHTML = '<option value="">Bulan</option>';
    daySelect.innerHTML = '<option value="">Tanggal</option>';
    monthSelect.disabled = true;
    daySelect.disabled = true;

    Array.from(years).sort((a,b)=>b-a).forEach(y => {
      const o = document.createElement('option');
      o.value = y;
      o.textContent = y;
      yearSelect.appendChild(o);
    });
  }

  function onYearChange(){
    const year = document.getElementById('filterYear').value;
    const monthSelect = document.getElementById('filterMonth');
    const daySelect = document.getElementById('filterDay');

    monthSelect.disabled = !year;
    daySelect.disabled = true;
    daySelect.innerHTML = '<option value="">Tanggal</option>';

    if(!year){
      filteredNews = [...allNews];
      renderNews(filteredNews);
      return;
    }

    let months = new Set();
    allNews.forEach(n => {
      if(n.date.startsWith(year)){
        months.add(n.date.substring(5,7));
      }
    });

    monthSelect.innerHTML = '<option value="">Bulan</option>';
    Array.from(months).sort().forEach(m=>{
      const o = document.createElement('option');
      o.value = m;
      o.textContent = m;
      monthSelect.appendChild(o);
    });

    applyDateFilter();
  }

  function onMonthChange(){
    const month = document.getElementById('filterMonth').value;
    const daySelect = document.getElementById('filterDay');

    daySelect.disabled = !month;
    daySelect.innerHTML = '<option value="">Tanggal</option>';

    if(!month){
      applyDateFilter();
      return;
    }

    const year = document.getElementById('filterYear').value;
    let days = new Set();

    allNews.forEach(n => {
      if(n.date.startsWith(year + '-' + month)){
        days.add(n.date.substring(8,10));
      }
    });

    Array.from(days).sort().forEach(d=>{
      const o = document.createElement('option');
      o.value = d;
      o.textContent = d;
      daySelect.appendChild(o);
    });

    applyDateFilter();
  }

  function applyAdvancedDateFilter(){
    applyDateFilter();
  }

  function applyDateFilter(){
    const year = document.getElementById('filterYear').value;
    const month = document.getElementById('filterMonth').value;
    const day = document.getElementById('filterDay').value;

    filteredNews = allNews.filter(n => {
      if(!n.date) return false;
      if(year && !n.date.startsWith(year)) return false;
      if(month && !n.date.substring(5,7) === month) return false;
      if(day && !n.date.endsWith(day)) return false;

      // Correct checks:
      if(month && n.date.substring(5,7) !== month) return false;
      if(day && n.date.substring(8,10) !== day) return false;

      return true;
    });

    renderNews(filteredNews);
  }

  function resetAdvancedDateFilter(){
    document.getElementById('filterYear').value = '';
    document.getElementById('filterMonth').innerHTML = '<option value="">Bulan</option>';
    document.getElementById('filterMonth').disabled = true;
    document.getElementById('filterDay').innerHTML = '<option value="">Tanggal</option>';
    document.getElementById('filterDay').disabled = true;
    filteredNews = [...allNews];
    renderNews(filteredNews);
  }

  // Visitor Section
  let visitors = JSON.parse(localStorage.getItem('visitors')) || [];

  function updateVisitorUI(){
    document.getElementById('visitor-count').textContent = visitors.length;
    const visitorListDiv = document.getElementById('visitor-list');
    if(visitors.length === 0){
      visitorListDiv.innerHTML = '<i>Belum ada pengunjung yang mengisi nama.</i>';
    } else {
      visitorListDiv.innerHTML = visitors.map(v => `<div>â€¢ ${v}</div>`).join('');
    }
  }

  function addVisitor(){
    const input = document.getElementById('visitor-name');
    let name = input.value.trim();
    if(name.length < 2){
      alert('Nama pengunjung minimal 2 karakter, bro!');
      input.focus();
      return;
    }
    if(visitors.includes(name)){
      alert('Nama ini sudah ada, bro.');
      input.value = '';
      input.focus();
      return;
    }
    visitors.push(name);
    localStorage.setItem('visitors', JSON.stringify(visitors));
    updateVisitorUI();
    input.value = '';
  }

  // Splash submit
  function submitName(){
    const input = document.getElementById('visitor-name-splash');
    const name = input.value.trim();
    if(name.length < 2){
      alert('Nama minimal 2 karakter, bro!');
      input.focus();
      return;
    }
    localStorage.setItem('visitorName', name);
    // Save to visitor list if belum ada
    if(!visitors.includes(name)){
      visitors.push(name);
      localStorage.setItem('visitors', JSON.stringify(visitors));
    }
    showMainContent();
  }

  function showMainContent(){
    document.getElementById('splash').style.display = 'none';
    document.getElementById('main-content').style.display = 'block';
    updateVisitorUI();
    fetchRSS('all');
  }

  window.onload = () => {
    const savedName = localStorage.getItem('visitorName');
    if(savedName && savedName.length >= 2){
      // Jika sudah ada nama, langsung tampilkan konten
      if(!visitors.includes(savedName)){
        visitors.push(savedName);
        localStorage.setItem('visitors', JSON.stringify(visitors));
      }
      showMainContent();
    }
  };
</script>

</body>
</html>
